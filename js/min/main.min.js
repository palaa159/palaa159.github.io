function generatePath(){for(var t=[],e=0;5>e;e++)t.push([500*e,randNum(400)]);return t}function translateAlong(t,e){var n=e.getTotalLength(),a=0;return function(){return function(r){var o=e.getPointAtLength(a*n),i=e.getPointAtLength(r*n),c=180*Math.atan2(i.y-o.y,i.x-o.x)/Math.PI;a=r;var l=i.x-t.width,s=i.y-t.height;return"translate("+l+","+s+")rotate("+c+" "+t.width+" "+t.height+")"}}}function randNum(t){return Math.floor(Math.random()*t)+1}function randomColor(){var t,e,n,a=Math.floor(120*Math.random())+120;return t="hsl("+a+",75%,30%)",e="hsl("+a+",75%,55%)",n="hsl("+a+",75%,80%)",{c1:t,c2:e,c3:n}}var s={},data=[],init=function(){console.log("see?"),updateScreen(),DB.main.query();var t={svgEl:null,planeArray:[]};t.init=function(){t.svgEl=d3.select("body").append("svg").attr({width:"100%",height:"600"});for(var n=20,a=0;n>a;a++)t.planeArray[a]=e.create();for(var r=0;n>r;r++)e.fly(r,randNum(5e3)+8e3);setTimeout(function(){delete t,$("svg").remove()},1e4)};var e={};e.create=function(){function e(){var t,e,n,a=0,r=0,o=randNum(2)+.5,i={x:56,y:5};return t="M"+a+" "+r+"L"+(a+i.x)*o+" "+(r+i.y)*o+"L"+a+"  "+(r+24)*o,e="M"+a+" "+r+"L"+(a+i.x)*o+" "+(r+i.y)*o+"L"+(a+12)*o+"  "+(r+24)*o,n="M"+a+" "+r+"L"+(a+i.x)*o+" "+(r+i.y)*o+"L"+(a-12)*o+"  "+(r+12)*o,{t1:t,t2:e,t3:n}}var n=e(),a=randomColor(),r=t.svgEl.append("g");return r.append("path").attr({d:n.t3}).style({fill:a.c1}),r.append("path").attr({d:n.t1}).style({fill:a.c2}),r.append("path").attr({d:n.t2}).style({fill:a.c3}),r},e.fly=function(e,n){var a=t.svgEl.append("path").data([generatePath()]).attr("d",d3.svg.line().tension(0).interpolate("basis"));t.planeArray[e].transition().duration(n).attrTween("transform",translateAlong(t.planeArray[e].node().getBBox(),a.node()))},t.init()},updateScreen=function(){s.width=window.innerWidth,s.height=window.innerHeight},renderProjects=function(){var t=$("#tpl-project").html();data.forEach(function(e,n){if(e.attributes.show){var a=_.template(t,{project:e.attributes,index:n});$("#projects .container").append(a)}}),attachEvents()},attachEvents=function(){$(".project").off("click").on("click",function(){var t=$(this).attr("data-index"),e=$("#tpl-project-detail").html(),n=_.template(e,{project:data[t].attributes});$("html,body").animate({scrollTop:$("#main-projects").offset().top}),$("#projects .container").html(n),attachEvents()}),$(".project-detail-close").off("click").on("click",function(){$(".project-detail-body").remove(),renderProjects(),$("html,body").animate({scrollTop:$("#main-projects").offset().top})})};$(window).on("resize",updateScreen),$(window).on("qSuccess",renderProjects),$(document).ready(init),$(function(){$("a[href*=#]:not([href=#])").click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var t=$(this.hash);if(t=t.length?t:$("[name="+this.hash.slice(1)+"]"),t.length)return $("html,body").animate({scrollTop:t.offset().top},500),!1}})});